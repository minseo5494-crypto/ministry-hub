# κ°μΈ ν•„κΈ° λ…ΈνΈ κΈ°λ¥ κµ¬ν„ κ³„νμ„

**μ‘μ„±μΌ**: 2025λ…„ 1μ›”
**μƒνƒ**: κ³„ν λ‹¨κ³„
**λ€μƒ κΈ°λ¥**: ν•„κΈ°λ΅ λ€μ²΄, λΌμ›λ„£κΈ°, μƒ λ…ΈνΈ λ§λ“¤κΈ°

---

## λ©μ°¨

1. [κ°μ”](#1-κ°μ”)
2. [ν„μ¬ μƒνƒ λ¶„μ„](#2-ν„μ¬-μƒνƒ-λ¶„μ„)
3. [κΈ°λ¥λ³„ μƒμ„Έ κ³„ν](#3-κΈ°λ¥λ³„-μƒμ„Έ-κ³„ν)
   - [3.1 ν•„κΈ°λ΅ λ€μ²΄](#31-ν•„κΈ°λ΅-λ€μ²΄)
   - [3.2 ν•„κΈ° λ…ΈνΈ λΌμ›λ„£κΈ°](#32-ν•„κΈ°-λ…ΈνΈ-λΌμ›λ„£κΈ°)
   - [3.3 μƒ λ…ΈνΈ λ§λ“¤κΈ°](#33-μƒ-λ…ΈνΈ-λ§λ“¤κΈ°)
4. [κΈ°μ  κµ¬ν„ μƒμ„Έ](#4-κΈ°μ -κµ¬ν„-μƒμ„Έ)
5. [UI/UX λ³€κ²½ μ‚¬ν•­](#5-uiux-λ³€κ²½-μ‚¬ν•­)
6. [κµ¬ν„ μμ„](#6-κµ¬ν„-μμ„)

---

## 1. κ°μ”

### 1.1 λ©μ 

μ‚¬μ©μκ°€ ν€ μ½ν‹°λ¥Ό κ°μΈν™”ν•  μ μλ” κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤. ν€ μ½ν‹° μ›λ³Έμ€ μ μ§€ν•λ©΄μ„ κ°μΈλ§ λ³Ό μ μλ” μ»¤μ¤ν„°λ§μ΄μ§•μ„ κ°€λ¥ν•κ² ν•©λ‹λ‹¤.

### 1.2 ν•µμ‹¬ μ›μΉ™

- **ν€ μ›λ³Έ μ μ§€**: κ°μΈν™”λ” λ³ΈμΈμ—κ²λ§ μ μ©λλ©° ν€ μ½ν‹°μ— μν–¥ μ—†μ
- **λΉ„νκ΄΄μ  μμ •**: μ–Έμ λ“  μ›λ³ΈμΌλ΅ λ³µμ› κ°€λ¥
- **μ¤ν”„λΌμΈ μ§€μ›**: λ΅μ»¬ μ¤ν† λ¦¬μ§€ + Supabase μ΄μ¤‘ μ €μ¥

### 1.3 κµ¬ν„ν•  κΈ°λ¥

| κΈ°λ¥ | μ„¤λ… | μ°μ„ μμ„ |
|------|------|----------|
| ν•„κΈ°λ΅ λ€μ²΄ | μ½ν‹°μ κ³΅μ„ λ‚΄ ν•„κΈ° λ…ΈνΈλ΅ λ€μ²΄ | λ†’μ |
| λΌμ›λ„£κΈ° | κ³΅ μ‚¬μ΄μ— λ‚΄ ν•„κΈ° λ…ΈνΈ μ‚½μ… | μ¤‘κ°„ |
| μƒ λ…ΈνΈ λ§λ“¤κΈ° | λΉ λ…ΈνΈ λλ” κ³΅ κΈ°λ° μƒ λ…ΈνΈ μƒμ„± | λ†’μ |

---

## 2. ν„μ¬ μƒνƒ λ¶„μ„

### 2.1 μ΄λ―Έ κµ¬ν„λ μΈν”„λΌ

#### usePersonalSetlistView ν›… (src/hooks/usePersonalSetlistView.ts)

```typescript
// μ΄λ―Έ κµ¬ν„λ ν•¨μλ“¤
replaceSongWithNote(userId, setlistId, originalSongId, noteId)  // λ€μ²΄ κΈ°λ¥
insertNoteAfter(userId, setlistId, afterOrder, noteId)          // λΌμ›λ„£κΈ° κΈ°λ¥
removeCustomization(userId, setlistId, noteId)                   // μ»¤μ¤ν„°λ§μ΄μ§• μ κ±°
clearAllCustomizations(userId, setlistId)                        // μ „μ²΄ μ΄κΈ°ν™”
getPersonalizedSongs(userId, setlistId, originalSongs, userNotes) // κ°μΈν™”λ λ©λ΅ μƒμ„±
```

#### useSheetMusicNotes ν›… (src/hooks/useSheetMusicNotes.ts)

```typescript
// μ΄λ―Έ κµ¬ν„λ ν•¨μλ“¤
saveNote(note)           // μƒ λ…ΈνΈ μ €μ¥
updateNote(note)         // λ…ΈνΈ μ—…λ°μ΄νΈ
deleteNote(noteId)       // λ…ΈνΈ μ‚­μ 
fetchNotes(userId)       // μ‚¬μ©μ λ…ΈνΈ λ©λ΅ μ΅°ν
fetchNotesBySong(songId) // νΉμ • κ³΅μ λ…ΈνΈ μ΅°ν
searchNotes(query)       // λ…ΈνΈ κ²€μƒ‰
```

#### λ°μ΄ν„° κµ¬μ΅°

```typescript
// κ°μΈ μ½ν‹° λ·° μ»¤μ¤ν„°λ§μ΄μ§•
interface SetlistCustomization {
  type: 'replace' | 'insert'
  originalSongId?: string  // replace μ‹ μ‚¬μ©
  afterOrder?: number      // insert μ‹ μ‚¬μ©
  noteId: string           // λ€μ²΄/μ‚½μ…ν•  λ…ΈνΈ ID
}

// λ΅μ»¬ ν•„κΈ° λ…ΈνΈ
interface LocalSheetMusicNote {
  id: string
  user_id: string
  song_id: string
  song_name: string
  team_name?: string
  file_url: string
  file_type: 'pdf' | 'image'
  title: string
  annotations: PageAnnotation[]
  // ... ν”Όμ•„λ…Έ/λ“λΌ μ•…λ³΄, μ†΅νΌ νƒκ·Έ λ“±
}
```

### 2.2 μμ •μ΄ ν•„μ”ν• νμΌ

| νμΌ | μμ • λ‚΄μ© |
|------|-----------|
| `src/app/my-team/[id]/setlist/[setlistId]/page.tsx` | λ€μ²΄/λΌμ›λ„£κΈ° UI μ¶”κ°€ |
| `src/app/my-notes/page.tsx` | μƒ λ…ΈνΈ λ§λ“¤κΈ° UI μ¶”κ°€ |

---

## 3. κΈ°λ¥λ³„ μƒμ„Έ κ³„ν

### 3.1 ν•„κΈ°λ΅ λ€μ²΄

#### 3.1.1 ν„μ¬ UI

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  1. κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©°                          Key: D          β”‚
β”‚     λ§μ»¤μ¤μ›μ‹­                                                  β”‚
β”‚     [μ•…λ³΄λ³΄κΈ°] [λ©”λ¨]                                          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  2. μ£Όλ‹κ» μκ΄‘                                  Key: E          β”‚
β”‚     μ μ΄μ–΄μ¤                                                    β”‚
β”‚     [μ•…λ³΄λ³΄κΈ°] [λ©”λ¨]                                          β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### 3.1.2 λ³€κ²½ ν›„ UI

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  1. κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©°                          Key: D          β”‚
β”‚     λ§μ»¤μ¤μ›μ‹­                                                  β”‚
β”‚     [μ•…λ³΄λ³΄κΈ°] [λ©”λ¨]   [λ‚΄ λ²„μ „ β–Ό]  β† λ“λ΅­λ‹¤μ΄ μ¶”κ°€           β”‚
β”‚                         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                 β”‚
β”‚                         β”‚ β—‹ μ›λ³Έ μ‚¬μ©          β”‚                 β”‚
β”‚                         β”‚ β— λ‚΄ ν•„κΈ° (01/05)   β”‚ β† λ‚΄ λ…ΈνΈ μ„ νƒ  β”‚
β”‚                         β”‚ β—‹ λ‚΄ ν•„κΈ° (12/20)   β”‚                 β”‚
β”‚                         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                 β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  2. μ£Όλ‹κ» μκ΄‘                   β“ λ‚΄ ν•„κΈ° μ μ©λ¨   Key: E    β”‚
β”‚     μ μ΄μ–΄μ¤                                                    β”‚
β”‚     [μ•…λ³΄λ³΄κΈ°] [λ©”λ¨]   [μ›λ³ΈμΌλ΅ β–Ό]  β† μ μ©λ μƒνƒ            β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### 3.1.3 λ™μ‘ νλ¦„

```
1. νμ΄μ§€ λ΅λ“
   β”β”€β”€ fetchPersonalView(userId, setlistId) νΈμ¶
   β”β”€β”€ fetchNotes(userId) νΈμ¶
   β””β”€β”€ κ° κ³΅λ³„λ΅ ν•΄λ‹Ή κ³΅μ λ…ΈνΈ μ΅΄μ¬ μ—¬λ¶€ ν™•μΈ

2. λ“λ΅­λ‹¤μ΄ ν‘μ‹ μ΅°κ±΄
   β””β”€β”€ ν•΄λ‹Ή song_idλ΅ μ €μ¥λ λ‚΄ ν•„κΈ° λ…ΈνΈκ°€ 1κ° μ΄μƒ μμ„ λ•

3. λ…ΈνΈ μ„ νƒ μ‹
   β”β”€β”€ replaceSongWithNote(userId, setlistId, songId, noteId) νΈμ¶
   β””β”€β”€ UI μ—…λ°μ΄νΈ (β“ ν‘μ‹)

4. μ›λ³ΈμΌλ΅ λ³µμ› μ‹
   β”β”€β”€ removeCustomization(userId, setlistId, noteId) νΈμ¶
   β””β”€β”€ UI μ—…λ°μ΄νΈ

5. μ•…λ³΄ λ³΄κΈ°/λ‹¤μ΄λ΅λ“ μ‹
   β””β”€β”€ μ„ νƒλ λ…ΈνΈμ file_url λ° annotations μ‚¬μ©
```

#### 3.1.4 κµ¬ν„ μ½”λ“ (μμ‚¬ μ½”λ“)

```tsx
// SortableSongItem μ»΄ν¬λ„νΈ λ‚΄λ¶€
const SongPersonalNoteDropdown = ({ song, userNotes, onSelect }) => {
  // ν•΄λ‹Ή κ³΅μ λ…ΈνΈλ§ ν•„ν„°λ§
  const notesForSong = userNotes.filter(n => n.song_id === song.song_id)

  if (notesForSong.length === 0) return null

  return (
    <Dropdown>
      <DropdownTrigger>
        {isReplaced ? 'λ‚΄ ν•„κΈ° μ μ©λ¨ β–Ό' : 'λ‚΄ λ²„μ „ β–Ό'}
      </DropdownTrigger>
      <DropdownMenu>
        <DropdownItem onClick={() => onSelect(null)}>
          μ›λ³Έ μ‚¬μ©
        </DropdownItem>
        {notesForSong.map(note => (
          <DropdownItem onClick={() => onSelect(note.id)}>
            {note.title} ({formatDate(note.updated_at)})
          </DropdownItem>
        ))}
      </DropdownMenu>
    </Dropdown>
  )
}
```

---

### 3.2 ν•„κΈ° λ…ΈνΈ λΌμ›λ„£κΈ°

#### 3.2.1 ν„μ¬ UI

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  1. κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©°                                          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  2. μ£Όλ‹κ» μκ΄‘                                                 β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  3. μ€ν μ•„λ‹λ©΄                                                 β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### 3.2.2 λ³€κ²½ ν›„ UI

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  1. κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©°                                          β”‚
β”‚                                                                  β”‚
β”‚  β”€ β”€ β”€ β”€ β”€ β”€ [+ λΌμ›λ„£κΈ°] β”€ β”€ β”€ β”€ β”€ β”€  β† hover μ‹ ν‘μ‹         β”‚
β”‚                                                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  2. μ£Όλ‹κ» μκ΄‘                                                 β”‚
β”‚                                                                  β”‚
β”‚  β”€ β”€ β”€ β”€ β”€ β”€ [+ λΌμ›λ„£κΈ°] β”€ β”€ β”€ β”€ β”€ β”€                           β”‚
β”‚                                                                  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  π“ μ°¬μ–‘ μ—°μµ λ©”λ¨ (λΌμ›λ„£μ)                          [μ κ±°]   β”‚
β”‚     λ‚λ§ λ³΄μ„ Β· 2025-01-05                                      β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  3. μ€ν μ•„λ‹λ©΄                                                 β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### 3.2.3 λ™μ‘ νλ¦„

```
1. λΌμ›λ„£κΈ° λ²„νΌ ν΄λ¦­
   β””β”€β”€ λ…ΈνΈ μ„ νƒ λ¨λ‹¬ μ—΄κΈ°

2. λ¨λ‹¬μ—μ„ λ…ΈνΈ μ„ νƒ
   β”β”€β”€ insertNoteAfter(userId, setlistId, afterOrder, noteId) νΈμ¶
   β””β”€β”€ UIμ— λΌμ›λ„£μ€ λ…ΈνΈ ν‘μ‹

3. μ κ±° λ²„νΌ ν΄λ¦­
   β”β”€β”€ removeCustomization(userId, setlistId, noteId) νΈμ¶
   β””β”€β”€ UIμ—μ„ μ κ±°

4. λ‹¤μ΄λ΅λ“ μ‹
   β””β”€β”€ getPersonalizedSongs()κ°€ λΌμ›λ„£μ€ λ…ΈνΈ ν¬ν•¨ν•μ—¬ λ°ν™
```

#### 3.2.4 λ…ΈνΈ μ„ νƒ λ¨λ‹¬

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  λΌμ›λ„£μ„ λ…ΈνΈ μ„ νƒ                                      [X]    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                  β”‚
β”‚  κ²€μƒ‰: [________________]                                        β”‚
β”‚                                                                  β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚ π“ κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©° (λ‚΄ λ²„μ „)                            β”‚ β”‚
β”‚  β”‚    λ§μ»¤μ¤μ›μ‹­ Β· μμ •: 2025-01-05                   [μ„ νƒ]  β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚                                                                  β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚ π“ μ—°μµμ© λ©”λ¨                                             β”‚ β”‚
β”‚  β”‚    λΉ λ…ΈνΈ Β· μμ •: 2025-01-04                      [μ„ νƒ]  β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚                                                                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

### 3.3 μƒ λ…ΈνΈ λ§λ“¤κΈ°

#### 3.3.1 ν„μ¬ UI (λ§μ΄νμ΄μ§€ > λ‚΄ ν•„κΈ° λ…ΈνΈ)

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  λ‚΄ ν•„κΈ° λ…ΈνΈ                                                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  π“ κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©° (ν•„κΈ°)                   [νΈμ§‘] [μ‚­μ ]   β”‚
β”‚  π“ μ£Όλ‹κ» μκ΄‘ (Eν‚¤ λ²„μ „)                      [νΈμ§‘] [μ‚­μ ]   β”‚
β”‚                                                                  β”‚
β”‚  (μƒ λ…ΈνΈλ¥Ό λ§λ“¤λ ¤λ©΄ κ³΅ κ²€μƒ‰ β†’ μ•…λ³΄ λ³΄κΈ° β†’ ν•„κΈ° ν•„μ”)          β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### 3.3.2 λ³€κ²½ ν›„ UI

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  λ‚΄ ν•„κΈ° λ…ΈνΈ                               [+ μƒ λ…ΈνΈ λ§λ“¤κΈ°]  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  π“ κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©° (ν•„κΈ°)                   [νΈμ§‘] [μ‚­μ ]   β”‚
β”‚  π“ μ£Όλ‹κ» μκ΄‘ (Eν‚¤ λ²„μ „)                      [νΈμ§‘] [μ‚­μ ]   β”‚
β”‚  π“ μ—°μµμ© λ©”λ¨                                 [νΈμ§‘] [μ‚­μ ]   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### 3.3.3 μƒ λ…ΈνΈ λ§λ“¤κΈ° λ¨λ‹¬

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  μƒ λ…ΈνΈ λ§λ“¤κΈ°                                          [X]    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                  β”‚
β”‚  λ…ΈνΈ μ λ© *                                                     β”‚
β”‚  [____________________________________]                          β”‚
β”‚                                                                  β”‚
β”‚  β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€  β”‚
β”‚                                                                  β”‚
β”‚  κΈ°λ° κ³΅ μ„ νƒ (μ„ νƒμ‚¬ν•­)                                         β”‚
β”‚                                                                  β”‚
β”‚  β—‹ κ³΅ μ—†μ΄ λΉ λ…ΈνΈλ΅ μ‹μ‘                                       β”‚
β”‚                                                                  β”‚
β”‚  β— κΈ°μ΅΄ κ³΅ κΈ°λ°μΌλ΅ λ§λ“¤κΈ°                                       β”‚
β”‚     κ³΅ κ²€μƒ‰: [κ°μ‚¬μ™€ μ°¬μ–‘__________] [κ²€μƒ‰]                      β”‚
β”‚                                                                  β”‚
β”‚     κ²€μƒ‰ κ²°κ³Ό:                                                   β”‚
β”‚     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚     β”‚ β—‹ κ°μ‚¬μ™€ μ°¬μ–‘ λ“λ¦¬λ©° - λ§μ»¤μ¤μ›μ‹­                    β”‚    β”‚
β”‚     β”‚ β—‹ κ°μ‚¬μ™€ μ°¬μ–‘μΌλ΅ - μ μ΄μ–΄μ¤                         β”‚    β”‚
β”‚     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚                                                                  β”‚
β”‚                                          [μ·¨μ†]  [λ§λ“¤κΈ°]       β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### 3.3.4 λ™μ‘ νλ¦„

```
1. "μƒ λ…ΈνΈ λ§λ“¤κΈ°" λ²„νΌ ν΄λ¦­
   β””β”€β”€ λ¨λ‹¬ μ—΄κΈ°

2-A. λΉ λ…ΈνΈλ΅ μ‹μ‘ μ„ νƒ μ‹
   β”β”€β”€ μ λ©λ§ μ…λ ¥
   β”β”€β”€ saveNote() νΈμ¶ (λΉ annotations)
   β””β”€β”€ μ—λ””ν„° μ—΄κΈ° (λΉ μΊ”λ²„μ¤)

2-B. κ³΅ κΈ°λ°μΌλ΅ λ§λ“¤κΈ° μ„ νƒ μ‹
   β”β”€β”€ κ³΅ κ²€μƒ‰ β†’ μ„ νƒ
   β”β”€β”€ saveNote() νΈμ¶ (κ³΅ μ •λ³΄ + λΉ annotations)
   β””β”€β”€ μ—λ””ν„° μ—΄κΈ° (κ³΅ μ•…λ³΄ λ°°κ²½μ— ν•„κΈ° κ°€λ¥)

3. μ—λ””ν„°μ—μ„ μ €μ¥
   β””β”€β”€ updateNote() νΈμ¶
```

#### 3.3.5 λΉ λ…ΈνΈ λ°μ΄ν„° κµ¬μ΅°

```typescript
const emptyNote: LocalSheetMusicNote = {
  id: generateUUID(),
  user_id: userId,
  song_id: '',              // λΉ λ…ΈνΈλ” song_id μ—†μ
  song_name: '',
  team_name: '',
  file_url: '',             // λΉ λ…ΈνΈλ” λ°°κ²½ μ΄λ―Έμ§€ μ—†μ
  file_type: 'image',
  title: userInputTitle,    // μ‚¬μ©μ μ…λ ¥ μ λ©
  annotations: [],
  pianoScores: [],
  drumScores: [],
  songForms: [],
  partTags: [],
  created_at: now,
  updated_at: now,
}
```

---

## 4. κΈ°μ  κµ¬ν„ μƒμ„Έ

### 4.1 λ°μ΄ν„°λ² μ΄μ¤

#### κΈ°μ΅΄ ν…μ΄λΈ” (λ³€κ²½ μ—†μ)

```sql
-- sheet_music_notes: ν•„κΈ° λ…ΈνΈ μ €μ¥
-- personal_setlist_views: κ°μΈ μ½ν‹° μ»¤μ¤ν„°λ§μ΄μ§• μ €μ¥
```

### 4.2 μƒνƒ κ΄€λ¦¬

#### μ½ν‹° μƒμ„Έ νμ΄μ§€ μ¶”κ°€ μƒνƒ

```typescript
// κΈ°μ΅΄ μƒνƒ
const [setlistSongs, setSetlistSongs] = useState<SetlistSong[]>([])
const { personalView, fetchPersonalView, replaceSongWithNote, insertNoteAfter } = usePersonalSetlistView()
const { notes, fetchNotes } = useSheetMusicNotes()

// μ¶”κ°€ν•  μƒνƒ
const [songNotesMap, setSongNotesMap] = useState<Record<string, LocalSheetMusicNote[]>>({})
const [showInsertModal, setShowInsertModal] = useState(false)
const [insertAfterOrder, setInsertAfterOrder] = useState<number | null>(null)
```

### 4.3 API νΈμ¶ νλ¦„

```
νμ΄μ§€ λ΅λ“
β”β”€β”€ fetchSetlistDetail()
β”β”€β”€ fetchPersonalView(userId, setlistId)
β””β”€β”€ fetchNotes(userId)
    β””β”€β”€ songNotesMap κµ¬μ„±

λ€μ²΄ μ„ νƒ
β””β”€β”€ replaceSongWithNote()
    β”β”€β”€ LocalStorage μ—…λ°μ΄νΈ
    β””β”€β”€ Supabase μ—…λ°μ΄νΈ (λΉ„λ™κΈ°)

λΌμ›λ„£κΈ°
β””β”€β”€ insertNoteAfter()
    β”β”€β”€ LocalStorage μ—…λ°μ΄νΈ
    β””β”€β”€ Supabase μ—…λ°μ΄νΈ (λΉ„λ™κΈ°)

λ‹¤μ΄λ΅λ“
β””β”€β”€ getPersonalizedSongs()
    β””β”€β”€ μ»¤μ¤ν„°λ§μ΄μ§• μ μ©λ κ³΅ λ©λ΅ λ°ν™
```

---

## 5. UI/UX λ³€κ²½ μ‚¬ν•­

### 5.1 μ½ν‹° μƒμ„Έ νμ΄μ§€ λ³€κ²½

| μμ—­ | λ³€κ²½ μ‚¬ν•­ |
|------|-----------|
| κ³΅ μ•„μ΄ν… | "λ‚΄ λ²„μ „" λ“λ΅­λ‹¤μ΄ μ¶”κ°€ |
| κ³΅ μ•„μ΄ν… | μ μ© μƒνƒ ν‘μ‹ (β“ λ‚΄ ν•„κΈ° μ μ©λ¨) |
| κ³΅ μ‚¬μ΄ | λΌμ›λ„£κΈ° λ²„νΌ μ¶”κ°€ (hover μ‹ ν‘μ‹) |
| λΌμ›λ„£μ€ λ…ΈνΈ | λ³„λ„ μ¤νƒ€μΌλ΅ ν‘μ‹ + μ κ±° λ²„νΌ |

### 5.2 λ§μ΄νμ΄μ§€ λ³€κ²½

| μμ—­ | λ³€κ²½ μ‚¬ν•­ |
|------|-----------|
| ν—¤λ” | "μƒ λ…ΈνΈ λ§λ“¤κΈ°" λ²„νΌ μ¶”κ°€ |
| λ¨λ‹¬ | μƒ λ…ΈνΈ μƒμ„± λ¨λ‹¬ μ¶”κ°€ |

### 5.3 μƒ‰μƒ/μ¤νƒ€μΌ κ°€μ΄λ“

```css
/* λΌμ›λ„£μ€ λ…ΈνΈ μ¤νƒ€μΌ */
.inserted-note {
  background: #FEF3C7;  /* μ—°ν• λ…Έλ€μƒ‰ λ°°κ²½ */
  border-left: 3px solid #F59E0B;  /* μ£Όν™©μƒ‰ μ™Όμ½ ν…λ‘λ¦¬ */
}

/* λ€μ²΄λ κ³΅ ν‘μ‹ */
.replaced-indicator {
  color: #059669;  /* λ…Ήμƒ‰ */
  font-size: 12px;
}

/* λΌμ›λ„£κΈ° λ²„νΌ */
.insert-button {
  opacity: 0;
  transition: opacity 0.2s;
}
.song-item:hover + .insert-button {
  opacity: 1;
}
```

---

## 6. κµ¬ν„ μμ„

### Phase 1: μƒ λ…ΈνΈ λ§λ“¤κΈ° (μμƒ μ‘μ—…λ‰: μ¤‘κ°„)

1. `my-notes/page.tsx`μ— "μƒ λ…ΈνΈ λ§λ“¤κΈ°" λ²„νΌ μ¶”κ°€
2. μƒ λ…ΈνΈ μƒμ„± λ¨λ‹¬ μ»΄ν¬λ„νΈ κµ¬ν„
3. κ³΅ κ²€μƒ‰ κΈ°λ¥ μ—°λ™
4. λΉ λ…ΈνΈ μƒμ„± λ΅μ§ κµ¬ν„
5. μ—λ””ν„° μ—°λ™

### Phase 2: ν•„κΈ°λ΅ λ€μ²΄ (μμƒ μ‘μ—…λ‰: μ¤‘κ°„)

1. μ½ν‹° μƒμ„Έ νμ΄μ§€μ—μ„ μ‚¬μ©μ λ…ΈνΈ λ΅λ“
2. songNotesMap μƒνƒ κµ¬μ„±
3. "λ‚΄ λ²„μ „" λ“λ΅­λ‹¤μ΄ μ»΄ν¬λ„νΈ κµ¬ν„
4. replaceSongWithNote μ—°λ™
5. μ μ© μƒνƒ ν‘μ‹ UI κµ¬ν„

### Phase 3: λΌμ›λ„£κΈ° (μμƒ μ‘μ—…λ‰: λ†’μ)

1. κ³΅ μ‚¬μ΄ λΌμ›λ„£κΈ° λ²„νΌ μ¶”κ°€
2. λ…ΈνΈ μ„ νƒ λ¨λ‹¬ κµ¬ν„
3. insertNoteAfter μ—°λ™
4. λΌμ›λ„£μ€ λ…ΈνΈ λ λ”λ§
5. getPersonalizedSongsμ™€ λ‹¤μ΄λ΅λ“ μ—°λ™

### Phase 4: ν…μ¤νΈ λ° κ°μ„ 

1. μ „μ²΄ ν”λ΅μ° ν…μ¤νΈ
2. μ—μ§€ μΌ€μ΄μ¤ μ²λ¦¬
3. μ¤ν”„λΌμΈ λ™κΈ°ν™” ν…μ¤νΈ
4. μ„±λ¥ μµμ ν™”

---

## λ³€κ²½ μ΄λ ¥

| λ‚ μ§ | λ²„μ „ | λ³€κ²½ λ‚΄μ© |
|------|------|-----------|
| 2025-01 | 1.0 | μµμ΄ μ‘μ„± |

---

*μ΄ λ¬Έμ„λ” WORSHEEP κ°μΈ ν•„κΈ° λ…ΈνΈ κΈ°λ¥ κµ¬ν„μ„ μ„ν• κ³„νμ„μ…λ‹λ‹¤.*
